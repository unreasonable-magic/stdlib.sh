#!/usr/bin/env bash

stdlib_path="$(realpath "$(dirname "$0")/..")"

case "$1" in
shellenv)
  printf "export STDLIB_PATH='%s'\n" "$stdlib_path"
  # shellcheck disable=SC2016
  printf 'source "$STDLIB_PATH/lib/stdlib/import.sh"\n'
  ;;

--help)
  man stdlib
  ;;

*)
  eval "$(stdlib shellenv)"
  stdlib::import "$1"
  if [[ "$*" == *" --help"* ]]; then
    manpage="stdlib-${1//\//-}"
    man "${manpage}"
  else
    funcname="${1//\//}"
    "${funcname}" "${@:2}"
  fi
  ;;
esac
